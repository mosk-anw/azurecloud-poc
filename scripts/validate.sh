#!/bin/bash
# Terraform Validation Script
# Generated by CloudAssist

set -e

echo "ğŸ” Running Terraform validation checks..."

# Change to terraform directory
cd terraform

# Check Terraform formatting
echo "ğŸ“‹ Checking Terraform formatting..."
terraform fmt -check -recursive

# Initialize Terraform (without backend for validation)
echo "âš™ï¸ Initializing Terraform..."
terraform init -backend=false

# Validate Terraform configuration
echo "âœ… Validating Terraform configuration..."
terraform validate

# Run security checks if tools are available
if command -v tfsec &> /dev/null; then
    echo "ğŸ›¡ï¸ Running TFSec security scan..."
    tfsec .
fi

if command -v checkov &> /dev/null; then
    echo "ğŸ” Running Checkov compliance scan..."
    checkov -d .
fi

echo "âœ… All validation checks passed!"
